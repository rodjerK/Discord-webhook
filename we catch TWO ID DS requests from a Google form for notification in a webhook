const POST_URL = ""; // URL-webhook

const USERNAME = "–°—É–¥–µ–±–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞"; // –ò–º—è –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
const AVATAR_URL = ""; // –°—Å—ã–ª–∫–∞ –Ω–∞ –∞–≤–∞—Ç–∞—Ä
const CONTENT = "<@&888888888888888888> <@&888888888888888888>"; // @—Ä–æ–ª—å
const COLOR = 333333; // –¶–≤–µ—Ç embed (—Å–µ—Ä—ã–π)
const TITLE = "‚Ä¢ –°—É–¥–µ–±–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ ‚Ä¢"; // –ó–∞–≥–æ–ª–æ–≤–æ–∫ 
const FOOTER = "–°—É–¥–µ–±–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞"; // –¢–µ–∫—Å—Ç —Å–Ω–∏–∑—É
const TIMESTAMP = true; // –í—Ä–µ–º—è –ø–æ—Å—Ç–∞ —Å–Ω–∏–∑—É

function onSubmit(e) {
    const response = e.response.getItemResponses();
    let items = [];
    let prosecutorId = ""; // ID –≥–æ—Å. –æ–±–≤–∏–Ω–∏—Ç–µ–ª—è
    let judgeId = ""; // ID –ø—Ä–µ–¥—Å–µ–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É—é—â–µ–≥–æ —Å—É–¥—å–∏

    for (const responseAnswer of response) {
        const question = responseAnswer.getItem().getTitle();
        const answer = responseAnswer.getResponse();
        
        // –ò–∑–≤–ª–µ–∫–∞–µ–º ID –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª–µ–π
        if (question.includes("–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –æ–±–≤–∏–Ω–∏—Ç–µ–ª—å:")) {
            prosecutorId = answer.match(/\d{17,19}/)?.[0] || "";
            continue;
        }
        
        if (question.includes("–ü—Ä–µ–¥—Å–µ–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É—é—â–∏–π —Å—É–¥—å—è:")) {
            judgeId = answer.match(/\d{17,19}/)?.[0] || "";
            continue;
        }
        
        // –û—Å—Ç–∞–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –¥–æ–±–∞–≤–ª—è–µ–º –≤ embed
        let parts = [];
        try {
            parts = answer.match(/[\s\S]{1,1024}/g) || [];
        } catch (e) {
            parts = answer;
        }

        if (!answer) continue;

        for (const [index, part] of Object.entries(parts)) {
            items.push({
                "name": index == 0 ? question : question + " (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ)",
                "value": part,
                "inline": false
            });
        }
    }

    // –§–æ—Ä–º–∏—Ä—É–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å —É–ø–æ–º–∏–Ω–∞–Ω–∏—è–º–∏
    let mentions = "";
    if (prosecutorId) mentions += `üë®‚Äç‚öñÔ∏è –ì–æ—Å. –æ–±–≤–∏–Ω–∏—Ç–µ–ª—å: <@${prosecutorId}>\n`;
    if (judgeId) mentions += `‚öñÔ∏è –ü—Ä–µ–¥—Å. —Å—É–¥—å—è: <@${judgeId}>\n`;
    
    const userMention = mentions + CONTENT;

    // –§–æ—Ä–º–∏—Ä—É–µ–º embed
    const embed = {
        "title": TITLE,
        "color": COLOR,
        "fields": items,
        "footer": { "text": FOOTER }
    };
    
    if (TIMESTAMP) embed.timestamp = new Date().toISOString();

    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Discord
    UrlFetchApp.fetch(POST_URL, {
        "method": "post",
        "headers": { "Content-Type": "application/json" },
        "payload": JSON.stringify({
            "content": userMention,
            "embeds": [embed],
            "username": USERNAME,
            "avatar_url": AVATAR_URL
        })
    });
};
